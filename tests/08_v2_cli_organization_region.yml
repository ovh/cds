name: Organization and Region Command testSuite
testcases:
- name: prepare test
  steps:
  - script: {{.cdsctl}} -f {{.cdsctl.config}} experimental organization remove myorg --force
  - script: {{.cdsctl}} -f {{.cdsctl.config}} experimental region remove my-region --force

- name: add new organization
  steps:
  - script: {{.cdsctl}} -f {{.cdsctl.config}} experimental organization add myorg
  - script: {{.cdsctl}} -f {{.cdsctl.config}} experimental organization get myorg --format json
    assertions:
      - result.code ShouldEqual 0
      - result.systemoutjson.name ShouldEqual myorg
  - script: {{.cdsctl}} -f {{.cdsctl.config}} experimental organization list --format json
    assertions:
      - result.code ShouldEqual 0
      - result.systemoutjson.__len__ ShouldEqual 2

- name: add new region
  steps:
    - script: {{.cdsctl}} -f {{.cdsctl.config}} experimental region add my-region
    - script: {{.cdsctl}} -f {{.cdsctl.config}} experimental region get my-region --format json
      assertions:
        - result.code ShouldEqual 0
        - result.systemoutjson.name ShouldEqual my-region
    - script: {{.cdsctl}} -f {{.cdsctl.config}} experimental region list --format json
      assertions:
        - result.code ShouldEqual 0
        - result.systemoutjson.systemoutjson0.name ShouldEqual "my-region"

- name: add region in organization
  steps:
    - script: {{.cdsctl}} -f {{.cdsctl.config}} experimental organization region add myorg my-region
    - script: {{.cdsctl}} -f {{.cdsctl.config}} experimental organization region list myorg --format json
      assertions:
        - result.code ShouldEqual 0
        - result.systemoutjson.__len__ ShouldEqual 1
        - result.systemoutjson.systemoutjson0.name ShouldEqual "my-region"
    - script: {{.cdsctl}} -f {{.cdsctl.config}} experimental organization region delete myorg my-region
      assertions:
        - result.code ShouldEqual 0
    - script: {{.cdsctl}} -f {{.cdsctl.config}} experimental organization region list myorg --format json
      assertions:
        - result.code ShouldEqual 0
        - result.systemoutjson.__len__ ShouldEqual 0

- name: remove organization and region
  steps:
    - script: {{.cdsctl}} -f {{.cdsctl.config}} experimental organization delete myorg --force
    - script: {{.cdsctl}} -f {{.cdsctl.config}} experimental region delete my-region --force
