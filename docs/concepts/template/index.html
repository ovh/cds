<!DOCTYPE html>
<html id="docs" lang="en" class="">
	<head>
	<meta charset="utf-8">
<title>Workflow Template - CDS - Continuous Delivery Service</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" type="image/png" href="../../../images/favicon.png">




<link rel="stylesheet" href="../../../sass/styles.css" integrity="" media="screen">
<link rel="stylesheet" href="../../../css/callouts.css">
<link rel="stylesheet" href="../../../css/auto-complete.css">
<link rel="stylesheet" href="../../../css/fontawesome.min.css">
<link rel="stylesheet" href="../../../css/asciinema-player.css">
<link rel="stylesheet" href="../../../css/solarized-light.css">

<meta name="description"
    content="What is a workflow template? A workflow template is useful to easily create a new workflow for a project. Also if you need to manage multiple workflows, you can use a template to create one unique and generic workflow then apply it on each workflow.
Templates are versioned, so you can easily improve your template then re-apply it on a workflow.
A template contains a workflow, pipelines, applications, environments in yaml format.">
<meta property="og:description"
    content="What is a workflow template? A workflow template is useful to easily create a new workflow for a project. Also if you need to manage multiple workflows, you can use a template to create one unique and generic workflow then apply it on each workflow.
Templates are versioned, so you can easily improve your template then re-apply it on a workflow.
A template contains a workflow, pipelines, applications, environments in yaml format.">
<meta name="twitter:description"
    content="What is a workflow template? A workflow template is useful to easily create a new workflow for a project. Also if you need to manage multiple workflows, you can use a template to create one unique and generic workflow then apply it on each workflow.
Templates are versioned, so you can easily improve your template then re-apply it on a workflow.
A template contains a workflow, pipelines, applications, environments in yaml format.">
<meta property="og:url" content="/docs/concepts/template/">
<meta property="og:title" content="Workflow Template">
<meta name="twitter:title" content="Workflow Template">
<meta name="twitter:image:alt" content="CDS - Continuous Delivery Service">
<meta property="og:image" content="/images/cds-transparent.png">
<script type="text/javascript" src="../../../js/anchor-4.1.1.min.js"></script>
<script type="text/javascript" src="../../../js/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="../../../js/jquery-ui-1.12.1.min.js"></script>
<script type="text/javascript" src="../../../js/bootstrap-3.3.7.min.js"></script>
<script type="text/javascript" src="../../../js/highlight.pack.js"></script>
<script>
    hljs.initHighlightingOnLoad();

</script>
<script type="text/javascript" src="../../../js/script.js"></script>
<script type="text/javascript" src="../../../js/lunr.min.js"></script>
<a id="indexJSON" href="../../../index.json"></a>

<script type="text/javascript" src="../../../js/auto-complete.js"></script>
<script type="text/javascript" src="../../../js/search.js"></script>
<script type="text/javascript" src="../../../js/asciinema-player.js"></script>

	</head>
	<body>
		<section id="hero" class="light-text no-sub">
			<a href="../../../" class="logo"></a>
				<i id="tocburger" class="fa fa-bars" onclick='$("#toc").toggle()'></i><div class="nav-buttons" data-auto-burger="primary">
				<ul class="global-nav">
					
					
					<li><a href="../../../docs/" class="active">Documentation</a></li>
					
					<li><a href="../../../hosting/">Hosting your own instance</a></li>
					
					<li><a href="../../../development/">CDS Developer Manual</a></li>
					
					<li><a href="../../../about/">About</a></li>
					
					<li><i class="fa fa-search" onclick='$("#searchbox").toggle(); $("#search-query").focus().select()'></i></li>
					<li>
						<div id="btn-gh">
							<a class="github-button" href="https://github.com/ovh/cds" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star CDS on GitHub">Star</a>
							<script async defer src="https://buttons.github.io/buttons.js"></script>
						</div>
					</li>
				</ul>
				<div id="searchbox">
					<input data-search-input id="search-query" type="text" placeholder="search...">
					<span data-search-clear=""><i class="fa fa-close"></i></span>
				</div>
			</div>

<div id="headSubMenu" class="light-text">




	

		

		
		<ul>
			
			
			
			<li><a href="../../../docs/">Home</a></li>
			
			
				
				<li><a href="../../../docs/concepts/" class="menuSelected">Concepts</a></li>
			
				
				<li><a href="../../../docs/actions/">Actions</a></li>
			
				
				<li><a href="../../../docs/components/">Components</a></li>
			
				
				<li><a href="../../../docs/integrations/">Integrations</a></li>
			
				
				<li><a href="../../../docs/tutorials/">Tutorials</a></li>
			
		</ul>
		
	

	

		

		
	

	

		

		
	

	

		

		
	

</div>


		</section>
		<section id="page-content-with-menu">
			
<div id="toc">
     <div class="toc-container">
        
        
        
        
        
            
                
                    
                        
                            
                                    
                                    
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                
            
        
            
                
                    
                        
                    
                        
                    
                
            
        
            
                
                    
                        
                    
                        
                    
                        
                    
                
            
        
            
                
                    
                
            
        
        
        <i class="fa fa-bars" id="tocburger" onclick='$("#toc").toggle()'></i> 
<a class="item" data-title="Concepts" href="../../../docs/concepts/"></a>

	
	
	
	
		
			
<a class="item" data-title="Authentication" href="../../../docs/concepts/authentication/"></a>

		
	
		
			
<a class="item" data-title="Job" href="../../../docs/concepts/job/"></a>

		
	
		
			
<a class="item" data-title="Project" href="../../../docs/concepts/project/"></a>

		
	
		
			
<a class="item" data-title="Permissions - ACLs" href="../../../docs/concepts/permissions/"></a>

		
	
		
			
<a class="item" data-title="Pipeline" href="../../../docs/concepts/pipeline/"></a>

		
	
		
			
<a class="item" data-title="Variables" href="../../../docs/concepts/variables/"></a>

		
	
		
			
<div class="item" data-title="Workflow">
	<div class="container">
		
		<a class="item" data-title="Workflow" href="../../../docs/concepts/workflow/"></a>
		
		
	
	
	
	
		
			
<a class="item" data-title="Payload" href="../../../docs/concepts/workflow/payload/"></a>

		
	
		
			
<a class="item" data-title="Pipeline Context" href="../../../docs/concepts/workflow/pipeline-context/"></a>

		
	
		
			
<div class="item" data-title="Hooks">
	<div class="container">
		
		<a class="item" data-title="Hooks" href="../../../docs/concepts/workflow/hooks/"></a>
		
		
	
	
	
	
		
			
<a class="item" data-title="Webhook" href="../../../docs/concepts/workflow/hooks/webhook/"></a>

		
	
		
			
<a class="item" data-title="Scheduler" href="../../../docs/concepts/workflow/hooks/scheduler/"></a>

		
	
		
			
<a class="item" data-title="Git Repository Webhook" href="../../../docs/concepts/workflow/hooks/git-repo-webhook/"></a>

		
	
		
			
<a class="item" data-title="Git Repository Poller" href="../../../docs/concepts/workflow/hooks/git-repo-poller/"></a>

		
	
		
			
<a class="item" data-title="Kafka hook" href="../../../docs/concepts/workflow/hooks/kafka-hook/"></a>

		
	
		
			
<a class="item" data-title="RabbitMQ hook" href="../../../docs/concepts/workflow/hooks/rabbitmq-hook/"></a>

		
	
		
			
<a class="item" data-title="Gerrit Hook" href="../../../docs/concepts/workflow/hooks/gerrit/"></a>

		
	

	</div>
</div>

		
	
		
			
<a class="item" data-title="Run conditions on pipeline" href="../../../docs/concepts/workflow/run-conditions/"></a>

		
	
		
			
<a class="item" data-title="Join" href="../../../docs/concepts/workflow/join/"></a>

		
	
		
			
<a class="item" data-title="Mutex" href="../../../docs/concepts/workflow/mutex/"></a>

		
	
		
			
<a class="item" data-title="Sidebar" href="../../../docs/concepts/workflow/sidebar/"></a>

		
	
		
			
<a class="item" data-title="Run Number" href="../../../docs/concepts/workflow/run-number/"></a>

		
	
		
			
<a class="item" data-title="Notifications" href="../../../docs/concepts/workflow/notifications/"></a>

		
	
		
			
<a class="item" data-title="Retention" href="../../../docs/concepts/workflow/retention/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Requirement">
	<div class="container">
		
		<a class="item" data-title="Requirement" href="../../../docs/concepts/requirement/"></a>
		
		
	
	
	
	
		
			
<a class="item" data-title="Region Requirement" href="../../../docs/concepts/requirement/requirement_region/"></a>

		
	
		
			
<a class="item" data-title="Secret Requirement" href="../../../docs/concepts/requirement/requirement_secret/"></a>

		
	
		
			
<a class="item" data-title="Service Link" href="../../../docs/concepts/requirement/requirement_service/"></a>

		
	
		
			
<a class="item" data-title="Memory" href="../../../docs/concepts/requirement/requirement_memory/"></a>

		
	
		
			
<a class="item" data-title="OS &amp; Architecture" href="../../../docs/concepts/requirement/requirement_os_arch/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Configuration files">
	<div class="container">
		
		<a class="item" data-title="Configuration files" href="../../../docs/concepts/files/"></a>
		
		
	
	
	
	
		
			
<a class="item" data-title="Workflow configuration file" href="../../../docs/concepts/files/workflow-syntax/"></a>

		
	
		
			
<a class="item" data-title="Pipeline configuration file" href="../../../docs/concepts/files/pipeline-syntax/"></a>

		
	
		
			
<a class="item" data-title="Worker Model configuration file" href="../../../docs/concepts/files/worker_model-syntax/"></a>

		
	
		
			
<a class="item" data-title="Action configuration file" href="../../../docs/concepts/files/action-syntax/"></a>

		
	
		
			
<a class="item" data-title="Application configuration file" href="../../../docs/concepts/files/application-syntax/"></a>

		
	
		
			
<a class="item" data-title="Environment configuration file" href="../../../docs/concepts/files/environment-syntax/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Worker Model">
	<div class="container">
		
		<a class="item" data-title="Worker Model" href="../../../docs/concepts/worker-model/"></a>
		
		
	
	
	
	
		
			
<a class="item" data-title="Worker Model patterns" href="../../../docs/concepts/worker-model/patterns/"></a>

		
	
		
			
<a class="item" data-title="Worker Model Variables" href="../../../docs/concepts/worker-model/variables/"></a>

		
	

	</div>
</div>

		
	
		
			
<a class="item" data-title="Workflow Template" href="../../../docs/concepts/template/"></a>

		
	





     </div>
</div>


			<div id="docsContent">
        		

<h1>Workflow Template</h1>



<nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-a-workflow-template">What is a workflow template?</a></li>
    <li><a href="#template-parameters">Template parameters</a></li>
    <li><a href="#apply-a-template">Apply a template</a></li>
    <li><a href="#bulk-apply-a-template">Bulk apply a template</a></li>
    <li><a href="#importcreateexport">Import/Create/Export</a></li>
    <li><a href="#deletechange-template-group">Delete/Change template group</a></li>
    <li><a href="#template-and-workflow-ascode">Template and workflow ascode</a></li>
  </ul>
</nav>

<h2 id="what-is-a-workflow-template">What is a workflow template?</h2>
<p>A workflow template is useful to easily create a new workflow for a project. Also if you need to manage multiple workflows, you can
use a template to create one unique and generic workflow then apply it on each workflow.</p>
<p>Templates are versioned, so you can easily improve your template then re-apply it on a workflow.</p>
<p>A template contains a workflow, pipelines, applications, environments in yaml format.
Each yaml file of a template is evaluated as a Golang template (with [[ and ]] delimiters) so loop or condition can be used in templates.</p>
<h2 id="template-parameters">Template parameters</h2>
<p>There are four types of custom parameters available in a template (string, boolean, repository, json).
<img src="../../../images/workflow_template_parameters.png" alt="Parameters"></p>
<p>There are some other parameters that are automatically added by CDS:</p>
<ul>
<li><strong>name</strong>: the name of the generated workflow given when template is applied (could be used to set the workflow name but also application names for example).</li>
<li><strong>id</strong>: the id of the template instance, this is unique for each generated workflow and reused when a template is re-applied (you can append this value to pipeline names to prevent override of existing pipeline).</li>
</ul>
<h2 id="apply-a-template">Apply a template</h2>
<p>To generate a new workflow from a template you should use the cdsctl. Then use the same command to update a generated workflow:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cdsctl template apply
</code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>You can also create a workflow from a template with the web UI.
<img src="../../../images/workflow_template_apply_ui.gif" alt="Apply"></p>
<h2 id="bulk-apply-a-template">Bulk apply a template</h2>
<p>To generate or update multiple workflows from a same template in one time you can use the bulk feature. This works both in cdsctl and cds ui:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cdsctl template bulk
</code></pre></div><p>You can also use a file to list all test instances that you want to generate and the values for all the required parameters.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">template_path</span>: <span style="color:#ae81ff">shared.infra/example-simple                                                          </span>
<span style="color:#f92672">instances</span>:                                                                                          
- <span style="color:#f92672">workflow_path</span>: <span style="color:#ae81ff">DEMO/demo1                                                                         </span>
  <span style="color:#f92672">parameters</span>:                                                                                       
  - <span style="color:#ae81ff">withDeploy=true                                                                                 </span>
  - <span style="color:#ae81ff">deployWhen=success                                                                              </span>
- <span style="color:#f92672">workflow_path</span>: <span style="color:#ae81ff">DEMO/demo2                                                                         </span>
  <span style="color:#f92672">parameters</span>:                                                                                       
  - <span style="color:#ae81ff">withDeploy=false                                                                                </span>
  - <span style="color:#ae81ff">data=[&#34;one&#34;, &#34;two&#34;] </span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cdsctl template bulk -f instances.yml
</code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p><img src="../../../images/workflow_template_bulk_ui.gif" alt="Bulk"></p>
<h2 id="importcreateexport">Import/Create/Export</h2>
<p>With cdsctl you can import/export a template from/to yaml files, you can also create a template in the UI from the <strong>settings</strong> menu:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cdsctl template push ./my-template/*.yml <span style="color:#75715e">#from local files</span>
cdsctl template push https://raw.githubusercontent.com/ovh/cds/master/tests/fixtures/template/simple/example-simple.yml <span style="color:#75715e">#from remote files</span>

cdsctl template pull shared.infra/my-template --output-dir ./my-template
</code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h2 id="deletechange-template-group">Delete/Change template group</h2>
<p>When removing a template, all info about the template and its instances are removed but all generated stuff will not be deleted.
With the CDS UI you can change the template name or group, this will not affect template instances or generated workflow but no group members will be able to re-apply the template anymore.</p>
<h2 id="template-and-workflow-ascode">Template and workflow ascode</h2>
<p>You can both use a template and a workflow ascode. When using a template your repository will only contains one yaml file with the name of the template that you want to use and the values for all the required template parameters.
You can create this file manually or directly with the CDS command line.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">name</span>: <span style="color:#ae81ff">demo</span>
<span style="color:#f92672">from</span>: <span style="color:#ae81ff">shared.infra/example-with-repository@1</span>
<span style="color:#f92672">parameters</span>:
  <span style="color:#f92672">deployWhen</span>: <span style="color:#ae81ff">manual</span>
  <span style="color:#f92672">repo</span>: <span style="color:#ae81ff">gitlab/richardlt/demo</span>
  <span style="color:#f92672">ssh_key_name</span>: <span style="color:#ae81ff">proj-ssh-key</span>
  <span style="color:#f92672">withDeploy</span>: <span style="color:#e6db74">&#34;true&#34;</span>
</code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>You can ask for a specific revision of the template or remove the version number to always get the its latest version.
This means that you can use different template versions for different branches of your repository.
Also you can change the template reference to use another template on a specific branch.</p>




			</div>
		</section><footer>
			<main>
			<a href="https://www.ovh.com"><img src="https://ovh.github.io/cds/images/logo-ovh-white-72DPI.png"></a>
			<div>
				The CDS logos are copyrighted.
				Icons made by <a href="https://www.flaticon.com/authors/eucalyp">Eucalyp</a> 
				from <a href="https://www.flaticon.com/">www.flaticon.com</a>
			</div>
			</main>
		</footer>

	</body>
</html>
