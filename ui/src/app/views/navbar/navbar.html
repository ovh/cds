<div class="ui inverted fixed menu navbar" *ngIf="ready">
    <a href="#" [routerLink]="['/']"><img src="assets/images/cds.png" class="item" title="{{'navbar_home' | translate}}"/></a>
    <ng-container *ngIf="currentUser">
        <a class="item link" href="#" [routerLink]="['/project', 'list', 'all']" *ngIf="currentUser">
            {{ 'navbar_projects' | translate }}
        </a>
        <div class="ui pointing dropdown link item" suiDropdown>
            <div class="text">{{'navbar_favorites' | translate}}</div>
            <i class="dropdown icon"></i>
            <div class="menu" suiDropdownMenu>
                <ng-container *ngIf="loading">
                  <div class="item">{{'common_loading' | translate}}</div>
                </ng-container>
                <ng-container *ngFor="let prj of listFavs">
                    <ng-container [ngSwitch]="prj.type">
                      <ng-container *ngSwitchCase="'workflow'">
                        <a class="item" sm-item href="#" [routerLink]="['/project', prj.key, 'workflow', prj.workflow_name]">
                          <div class="details">
                            <div class="title bold">
                                {{prj.workflow_name}}
                            </div>
                            <div class="info mt">
                                {{'navbar_workflow_in' | translate}} {{prj.key}}
                            </div>
                          </div>
                        </a>
                      </ng-container>
                      <ng-container *ngSwitchCase="'application'">
                        <a class="item" sm-item href="#" [routerLink]="['/project', prj.key, 'application', prj.application_name]">
                          <div class="details">
                            <div class="title bold">
                                {{prj.application_name}}}
                            </div>
                            <div class="info mt">
                                {{'navbar_application_in' | translate}} {{prj.key}}
                            </div>
                          </div>
                        </a>
                      </ng-container>
                      <ng-container *ngSwitchDefault>
                        <a class="item" sm-item href="#" [routerLink]="['/project', prj.key]">
                          <div class="details">
                            <div class="title bold">
                                {{prj.name}}
                            </div>
                            <div class="info mt">
                                {{'common_project' | translate}}
                            </div>
                          </div>
                        </a>
                      </ng-container>
                    </ng-container>
                </ng-container>
                <a class="item" sm-item href="#" [routerLink]="['/favorite']">
                  {{'common_favorites_all' | translate}}
                </a>
            </div>
        </div>
    </ng-container>
    <a class="item link" href="#" [routerLink]="['/project']" *ngIf="currentUser">
        {{ 'navbar_project_create' | translate }}
    </a>

    <div class="right menu details">
        <ng-template let-result let-query="query" #searchTemplate>
            <div>
              <div class="title">
                  {{result.title}}
                  <div class="inline floated right" *ngIf="result.favorite">
                    <i class="pointing star icon favorite"></i>
                  </div>
              </div>
              <div class="info">
                  <span *ngIf="result.type === 'workflow'">{{'navbar_workflow_in' | translate}}</span>
                  <span *ngIf="result.type === 'application'">{{'navbar_application_in' | translate}}</span>
                  <span *ngIf="result.type === 'project'">{{'common_project' | translate}}</span>
                  <span class="ui text tiny blue" *ngIf="result.type !== 'project'">{{result.projectKey}}</span>
              </div>
            </div>
        </ng-template>
        <sui-search
            placeholder="{{'navbar_search' | translate}}"
            [optionsFilter]="searchItem"
            [resultTemplate]="searchTemplate"
            [options]="items"
            [maxResults]="10"
            [allowEmptyQuery]="true"
            [retainSelectedResult]="false"
            [resetQueryOnChange]="false"
            (keydown)="searchEvent($event)"
            (resultSelected)="navigateToResult($event)">
        </sui-search>

        <sm-dropdown icon="settings" *ngIf="currentUser">
            <a sm-item href="#" [routerLink]="['settings', 'user', currentUser.username]">{{ 'navbar_profile' | translate }}</a>
            <a sm-item href="#" [routerLink]="['settings', 'action']">{{ 'navbar_actions' | translate }}</a>
            <a sm-item *ngIf="currentUser.admin" href="#" [routerLink]="['settings', 'user']">{{ 'navbar_users' | translate }}</a>
            <a sm-item href="#" [routerLink]="['settings', 'group']">{{ 'navbar_groups' | translate }}</a>
            <a sm-item href="#" [routerLink]="['settings', 'worker-model']">{{ 'navbar_worker_models' | translate }}</a>
            <div class="divider"></div>
            <a sm-item href="#" [routerLink]="['settings', 'downloads']">{{ 'navbar_downloads' | translate }}</a>
            <a sm-item href="https://ovh.github.io/cds/" target="_blank">{{ 'navbar_documentation' | translate }}</a>
        </sm-dropdown>
        <sm-dropdown icon="student" *ngIf="currentUser && currentUser.admin">
            <a sm-item href="#" [routerLink]="['admin', 'broadcast']">{{ 'navbar_admin_broadcast' | translate }}</a>
            <a sm-item href="#" [routerLink]="['admin', 'migration']">{{ 'navbar_admin_migration' | translate }}</a>
            <a sm-item href="#" [routerLink]="['admin', 'status']">{{ 'navbar_admin_status' | translate }}</a>
        </sm-dropdown>
        <sm-select class="languageSelect"
            [options]="{'fullTextSearch': true}"
            [(model)]="currentCountry"
            (modelChange)="changeCountry()">
            <option value="fr"><i class="france flag"></i></option>
            <option value="en"><i class="gb flag"></i></option>
        </sm-select>
        <div class="item link">
            <a routerLink="/account/login" routerLinkActive="active">
                <i class="fa fa-sign-out"></i>
            </a>
        </div>
    </div>
</div>
